### New dataset created with data 28 OCT 2004 ###
R> jlgc <-read.table("seedrain9799.txt",header=TRUE,sep="\t",dec=",",na.strings="NA")
R> pmah.nch <-read.table("pmah_nch9799seedrain.txt",header=TRUE,sep="\t",dec=",",na.strings="NA")
R> jlgc.nch <-read.table("seedrain_nch9799.txt",header=TRUE,sep="\t",dec=",",na.strings="NA")
R> ls()
[1] "jlgc"      "jlgc.nch"  "pmah.nch"  "pmahtraps" "sdbvul"    "sdcmon"   
R> names(jlgc.nch)
  [1] "ord"              "site"             "site2"            "mhab"            
  [5] "mhab2"            "trap"             "name"             "ox"              
  [9] "oy"               "x"                "y"                "spp.pral"        
 [13] "pl.agra97"        "seed.agra9798"    "pl.agra98"        "seed.agra9899"   
 [17] "pl.agra99"        "pl.aita97"        "seed.aita9798"    "pl.aita98"       
 [21] "seed.aita9899"    "pl.aita99"        "pl.aova97"        "seed.aova9798"   
 [25] "pl.aova98"        "seed.aova9899"    "pl.aova99"        "pl.bvul97"       
 [29] "seed.bvul9798"    "pl.bvul98"        "seed.bvul9899"    "pl.bvul99"       
 [33] "pl.cgra97"        "seed.cgra9798"    "pl.cgra98"        "seed.cgra9899"   
 [37] "pl.cgra99"        "pl.cmon97"        "seed.cmon9798"    "pl.cmon98"       
 [41] "seed.cmon9899"    "pl.cmon99"        "pl.dlau97"        "seed.dlau9798"   
 [45] "pl.dlau98"        "seed.dlau9899"    "pl.dlau99"        "pl.hhel97"       
 [49] "seed.hhel9798"    "pl.hhel98"        "seed.hhel9899"    "pl.hhel99"       
 [53] "pl.jcom97"        "seed.jcom9798"    "pl.jcom98"        "seed.jcom9899"   
 [57] "pl.jcom99"        "pl.jpho97"        "seed.jpho9798"    "pl.jpho98"       
 [61] "seed.jpho9899"    "pl.jpho99"        "pl.jsab97"        "seed.jsab9798"   
 [65] "pl.jsab98"        "seed.jsab9899"    "pl.jsab99"        "pl.joxy97"       
 [69] "seed.joxy9798"    "pl.joxy98"        "seed.joxy9899"    "pl.joxy99"       
 [73] "pl.larb97"        "seed.larb9798"    "pl.larb98"        "seed.larb9899"   
 [77] "pl.larb99"        "pl.lspl97"        "seed.lspl9798"    "pl.lspl98"       
 [81] "seed.lspl9899"    "pl.lspl99"        "pl.pbro97"        "seed.pbro9798"   
 [85] "pl.pbro98"        "seed.pbro9899"    "pl.pbro99"        "pl.pmah97"       
 [89] "seed.pmah9798"    "pl.pmah98"        "seed.pmah9899"    "pl.pmah99"       
 [93] "seed.pmah99"      "pl.pnig97"        "seed.pnig9798"    "pl.pnig98"       
 [97] "seed.pnig9899"    "pl.pnig99"        "pl.qspp97"        "seed.qspp9798"   
[101] "pl.qspp98"        "seed.qspp9899"    "pl.qspp99"        "pl.rosa97"       
[105] "seed.rosa9798"    "pl.rosa98"        "seed.rosa9899"    "pl.rosa99"       
[109] "pl.rhamnus97"     "seed.rhamnus9798" "pl.98rhamnus"     "seed.rhamnus9899"
[113] "pl.rhamnus99"     "pl.sari97"        "seed.sari9798"    "pl.sari98"       
[117] "seed.sari9899"    "pl.sari99"        "pl.tbac97"        "seed.tbac9798"   
[121] "pl.tbac98"        "seed.tbac9899"    "pl.tbac99"        "seed.tbac99"     
[125] "pl.podo97"        "seed.podo9798"    "pl.podo98"        "seed.podo9899"   
[129] "pl.99podo"        "pl.rper97"        "seed.rper9798"    "pl.rper98"       
[133] "seed.rper9899"    "pl.rper99"       
R> str(jlgc.nch)
data.frame:	747 obs. of  134 variables:
 $ ord             : int  1 2 3 4 5 6 7 8 9 10 ...
 $ site            : Factor w/ 3 levels "IN","OUT": 1 1 1 1 1 1 1 1 1 1 ...
 $ site2           : Factor w/ 5 levels "DRCHA",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ mhab            : Factor w/ 6 levels "A","B","N","P",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ mhab2           : Factor w/ 21 levels "A","Aita","Aova",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ trap            : Factor w/ 83 levels "","1","10","11",..: 2 13 24 35 46 59 70 81 83 3 ...
 $ name            : Factor w/ 747 levels "Aita","Aova",..: 3 14 16 17 18 19 20 21 22 4 ...
 $ ox              : num   -31.8  -78.3 -106.6 -111.2 -112.5 ...
 $ oy              : num  -3.03 19.82 59.05 49.39 61.24 ...
 $ x               : num  168.2 121.7  93.4  88.8  87.5 ...
 $ y               : num  297 320 359 349 361 ...
 $ spp.pral        : Factor w/ 28 levels "Agra","Aita",..: 13 13 13 17 17 6 6 17 6 17 ...
 $ pl.agra97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.agra9798   : int  0 0 0 0 0 0 0 0 0 1 ...
 $ pl.agra98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.agra9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.agra99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.aita97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.aita9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.aita98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.aita9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.aita99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.aova97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.aova9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.aova98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.aova9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.aova99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.bvul97       : int  0 0 0 1 0 1 0 0 0 0 ...
 $ seed.bvul9798   : int  5 3 0 0 0 4 0 0 0 0 ...
 $ pl.bvul98       : int  1 0 0 0 0 0 0 0 0 0 ...
 $ seed.bvul9899   : int  8 6 7 NA 0 6 0 0 2 7 ...
 $ pl.bvul99       : int  3 0 0 0 0 0 0 0 0 1 ...
 $ pl.cgra97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.cgra9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.cgra98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.cgra9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.cgra99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.cmon97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.cmon9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.cmon98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.cmon9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.cmon99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.dlau97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.dlau9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.dlau98       : int  1 0 0 0 0 0 0 0 0 0 ...
 $ seed.dlau9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.dlau99       : int  1 0 0 0 0 0 0 0 0 0 ...
 $ pl.hhel97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.hhel9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.hhel98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.hhel9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.hhel99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.jcom97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.jcom9798   : int  0 0 0 0 0 0 0 0 0 1 ...
 $ pl.jcom98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.jcom9899   : int  0 0 0 NA 0 0 0 0 0 1 ...
 $ pl.jcom99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.jpho97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.jpho9798   : int  0 1 0 0 0 1 0 0 0 0 ...
 $ pl.jpho98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.jpho9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.jpho99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.jsab97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.jsab9798   : int  0 2 0 0 0 0 0 0 0 0 ...
 $ pl.jsab98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.jsab9899   : int  2 0 0 NA 0 0 0 0 0 0 ...
 $ pl.jsab99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.joxy97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.joxy9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.joxy98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.joxy9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.joxy99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.larb97       : int  0 1 0 0 0 0 0 0 0 0 ...
 $ seed.larb9798   : int  7 1 0 0 0 0 0 0 0 0 ...
 $ pl.larb98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.larb9899   : int  6 7 0 NA 0 0 0 0 4 0 ...
 $ pl.larb99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.lspl97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.lspl9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.lspl98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.lspl9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.lspl99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.pbro97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.pbro9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.pbro98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.pbro9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.pbro99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.pmah97       : int  0 0 0 2 0 2 0 0 0 0 ...
 $ seed.pmah9798   : int  0 4 7 2 14 4 3 4 0 70 ...
 $ pl.pmah98       : int  0 1 0 0 0 0 1 0 1 0 ...
 $ seed.pmah9899   : int  0 1 11 NA 3 23 3 3 1 8 ...
 $ pl.pmah99       : int  0 0 0 3 1 0 1 0 0 0 ...
 $ seed.pmah99     : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.pnig97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.pnig9798   : int  1 0 0 14 1 1 4 0 2 0 ...
 $ pl.pnig98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.pnig9899   : int  0 0 2 NA 0 1 1 1 1 0 ...
 $ pl.pnig99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.qspp97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.qspp9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.qspp98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.qspp9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.qspp99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.rosa97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.rosa9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.rosa98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.rosa9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.rosa99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.rhamnus97    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.rhamnus9798: int  0 11 8 0 0 15 2 0 1 0 ...
 $ pl.98rhamnus    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.rhamnus9899: int  0 7 4 NA 0 8 3 0 0 1 ...
 $ pl.rhamnus99    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.sari97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.sari9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.sari98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.sari9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.sari99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.tbac97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.tbac9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.tbac98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.tbac9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.tbac99       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.tbac99     : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.podo97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.podo9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.podo98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.podo9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.99podo       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.rper97       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.rper9798   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ pl.rper98       : int  0 0 0 0 0 0 0 0 0 0 ...
 $ seed.rper9899   : int  0 0 0 NA 0 0 0 0 0 0 ...
 $ pl.rper99       : int  0 0 0 0 0 0 0 0 0 0 ...
R> 
## Level plots for representing the seed shadows
levelplot(marks~x*y,grid,cuts= 5)
levelplot(marks~x*y,grid,cuts= 10)
grid<-expand.grid(X=seq(0,500,25),Y=seq(0,1200,25))
levelplot(marks~x*y,grid,cuts= 5,shrink=c(5,5),contour=T)
detach()
attach(totrain)
levelplot(seeds~ox*oy,grid,cuts= 5,shrink=c(5,5),contour=T)
levelplot(seeds~ox*oy,grid,cuts= 5,shrink=c(50,50),contour=T,region=T,at=c(0,10,20,30,40,50,60,70))
detach()

attach(sdpmah)
names(sdpmah)
library(ade4)

wxy<-data.frame(x,y)
s.image(wxy,marks)
s.image(wxy,marks,contour.plot=F)
s.image(wxy,sdpnig$marks,contour.plot=F)
s.image(wxy,sdpnig$marks,contour.plot=F)
s.image(wxy,sdbvul$marks,contour.plot=F)
s.image(wxy,sdcmon$marks,contour.plot=F)
s.image(wxy,sdbvul$marks,contour.plot=F)

names(totrain)
s.image(wxy,totrain$seeds,contour.plot=F)
par(mfrow=c(1,2))
s.image(wxy,totrain$seeds,contour.plot=F)
s.image(wxy,totrain$seedl,contour.plot=F)

###########
R> 
# Plots with transparency color
pdf("alpha.pdf", version = "1.4", + width = 4, height = 4)
par(mar = c(5, 4, 2, 2))
plot(rnorm(500), rnorm(500), + col = rgb(0, 0, 1, 0.2), + pch = 16)
dev.off()

plot(sdpnig,+ col = rgb(0, 0, 1, 0.2), + pch = 16)

R> attach(jlgc.nch)
sdbvul <- ppp(x, y, c(0,500), c(0,1200), marks=seed.bvul9798+seed.bvul9899)
sdpnig <- ppp(x, y, c(0,500), c(0,1200), marks=seed.pnig9798+seed.pnig9899)
sdagra <- ppp(x, y, c(0,500), c(0,1200), marks=seed.agra9798+seed.agra9899)
sdpmah <- ppp(x, y, c(0,500), c(0,1200), marks=seed.pmah9798+seed.pmah9899+seed.pmah99)
sdtbac <- ppp(x, y, c(0,500), c(0,1200), marks=seed.tbac9798+seed.tbac9899)
sdqspp <- ppp(x, y, c(0,500), c(0,1200), marks=seed.qspp9798+seed.qspp9899)
sdrosa <- ppp(x, y, c(0,500), c(0,1200), marks=seed.rosa9798+seed.rosa9899)

wxy<-data.frame(x,y)
par(mfrow=c(2,2))
s.image(wxy,sdpmah$marks,contour.plot=F,sub="Prunus mahaleb",csub=2)
s.image(wxy,sdtbac$marks,contour.plot=F,sub="Taxus baccata",csub=2)
s.image(wxy,sdbvul$marks,contour.plot=F,sub="Berberis vulgaris",csub=2)
s.image(wxy,sdcmon$marks,contour.plot=F,sub="Crategus monogyna",csub=2)
s.image(wxy,sdagra$marks,contour.plot=F,sub="Acer granatense",csub=2)
s.image(wxy,sdpnig$marks,contour.plot=F,sub="Pinus nigra",csub=2)
s.image(wxy,sdqspp$marks,contour.plot=F,sub="Quercus spp.",csub=2)
s.image(wxy,sdrosa$marks,contour.plot=F,sub="Rosa spp.",csub=2)
R> 

plbvul <- ppp(x, y, c(0,500), c(0,1200), marks=pl.bvul97+pl.bvul98+pl.bvul99)
plpnig <- ppp(x, y, c(0,500), c(0,1200), marks=pl.pnig97+pl.pnig98+pl.pnig99)
plagra <- ppp(x, y, c(0,500), c(0,1200), marks=pl.agra97+pl.agra98+pl.agra99)
plpmah <- ppp(x, y, c(0,500), c(0,1200), marks=pl.pmah97+pl.pmah98+pl.pmah99)
pltbac <- ppp(x, y, c(0,500), c(0,1200), marks=pl.tbac97+pl.tbac98+pl.tbac99)
plqspp <- ppp(x, y, c(0,500), c(0,1200), marks=pl.qspp97+pl.qspp98+pl.qspp99)
plrosa <- ppp(x, y, c(0,500), c(0,1200), marks=pl.rosa97+pl.rosa98+pl.rosa99)


s.image(wxy,plpmah$marks,contour.plot=F,sub="Prunus mahaleb",csub=2)
s.image(wxy,pltbac$marks,contour.plot=F,sub="Taxus baccata",csub=2)
s.image(wxy,plbvul$marks,contour.plot=F,sub="Berberis vulgaris",csub=2)
s.image(wxy,plcmon$marks,contour.plot=F,sub="Crategus monogyna",csub=2)
s.image(wxy,plagra$marks,contour.plot=F,sub="Acer granatense",csub=2)
s.image(wxy,plpnig$marks,contour.plot=F,sub="Pinus nigra",csub=2)
s.image(wxy,plrosa$marks,contour.plot=F,sub="Rosa spp.",csub=2)
###
par(mfrow=c(1,2))
s.image(wxy,sdpmah$marks,contour.plot=F,sub="Prunus mahaleb",csub=2)
s.image(wxy,plpmah$marks,contour.plot=F,sub="Prunus mahaleb",csub=2)
par(mfrow=c(1,2))
plot(sdpmah)
plot(plpmah)
par(mfrow=c(1,2))
s.image(wxy,sdpnig$marks,contour.plot=F,sub="Seeds",csub=2)
s.image(wxy,plpnig$marks,contour.plot=F,sub="Seedlings",csub=2)

par(mfrow=c(1,2),title="Quercus spp.")
s.image(wxy,sdqspp$marks,contour.plot=F,sub="Quercus spp.-Seeds",csub=2)
s.image(wxy,plqspp$marks,contour.plot=F,sub="Quercus spp.-Seedlings",csub=2)


###
sdpmah97 <- ppp(x, y, c(0,500), c(0,1200), marks=seed.pmah9798)
plpmah98 <- ppp(x, y, c(0,500), c(0,1200), marks=pl.pmah98)
sdpmah98 <- ppp(x, y, c(0,500), c(0,1200), marks=seed.pmah9899)
plpmah99 <- ppp(x, y, c(0,500), c(0,1200), marks=pl.pmah99)

par(mfrow=c(2,2))
s.image(wxy,sdpmah97$marks,contour.plot=F,sub="Seeds 1997",csub=2)
s.image(wxy,plpmah98$marks,contour.plot=F,sub="Seedlings 1998",csub=2)
s.image(wxy,sdpmah98$marks,contour.plot=F,sub="Seeds 1998",csub=2)
s.image(wxy,plpmah99$marks,contour.plot=F,sub="Seedlings 1999",csub=2)
par(mfrow=c(2,2))
plot(sdpmah97)
plot(plpmah98)
plot(sdpmah98)
plot(plpmah99)

# Plots with transparency color
pdf("pmah_9799.pdf", version = "1.4", width = 6, height = 6)
par(mfrow=c(2,2))
plot(sdpmah97, bg= rgb(0, 0, 1, 0.3), lty=0,main="Prunus maheleb", sub="Seeds 1997")
plot(plpmah98, bg= rgb(0, 0, 1, 0.3), lty=0, sub="Seedlings 1998")
plot(sdpmah98, bg= rgb(0, 0, 1, 0.3), lty=0, sub="Seeds 1998")
plot(plpmah99, bg= rgb(0, 0, 1, 0.3), lty=0, sub="Seedlings 1999")
dev.off()




